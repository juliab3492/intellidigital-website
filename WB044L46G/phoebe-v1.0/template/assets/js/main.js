//
// recommend do not edit this file
// --------------------------------------------------
//

var $ = jQuery.noConflict();

(function($) {
  'use strict';

//
// function start
// --------------------------------------------------
//

  var BONEFISHCODE = {
    ready: function() {
      BONEFISHCODE.fn_deviceDetect();
      BONEFISHCODE.fn_scrollspy();
      BONEFISHCODE.fn_popup();
      BONEFISHCODE.fn_form();
      BONEFISHCODE.fn_slideshow();
      BONEFISHCODE.fn_youtube();
      BONEFISHCODE.fn_countdown();
      BONEFISHCODE.fn_utility();
    },
    load: function() {
      BONEFISHCODE.fn_pageLoader();
      BONEFISHCODE.fn_smoothScroll();
      BONEFISHCODE.fn_navbar();
      BONEFISHCODE.fn_sticky();
      BONEFISHCODE.fn_hero();
      BONEFISHCODE.fn_animation();
      BONEFISHCODE.fn_carousel();
      BONEFISHCODE.fn_bgAudio();
    },
    scroll: function() {
      BONEFISHCODE.fn_sticky();
    },
    resize: function() {
      BONEFISHCODE.fn_navbar();
      BONEFISHCODE.fn_sticky();
    },
    orientationchange: function() {
      BONEFISHCODE.fn_navbar();
      BONEFISHCODE.fn_hero();
    },

//
// device detect
// --------------------------------------------------

    fn_deviceDetect: function() {
      if ($html.hasClass('desktop')) {
        isMobile = false;
        isDesktop = true;
      } else {
        isMobile = true;
        isDesktop = false;
      }
    },

//
// countdown
// --------------------------------------------------
//

    fn_countdown: function() {
      $('.countdown').each(function() {
        var $this = $(this);

        $this.countdown($this.data('countdown-date'), function(e) {
          $this.find('.countdown-day .countdown-digit').html(e.strftime('%D'));
          $this.find('.countdown-hour .countdown-digit').html(e.strftime('%H'));
          $this.find('.countdown-minute .countdown-digit').html(e.strftime('%M'));
          $this.find('.countdown-second .countdown-digit').html(e.strftime('%S'));
        });
      });
    },

//
// page loader
// --------------------------------------------------
//

    fn_pageLoader: function() {
      var $pageLoader = $('.page-loader');

      if ($pageLoader.length) {
        $pageLoader.velocity('fadeOut', {
          duration: pageLoaderDuration,
          easing: easeInOutQuart,
          complete: function() {
            $(this).remove();
            $html.addClass('js-page-loaded');
          }
        });
      }
    },

//
// navbar
// --------------------------------------------------
//

    fn_navbar: function() {
      $('.navbar-collapse').css({ maxHeight: $(window).height() - $('.navbar-header').height() + 'px' });
    },

//
// scrollspy
// --------------------------------------------------
//

    fn_scrollspy: function() {
      var target = '.page-navbar';
      var offset = $(target).find('.navbar-header').outerHeight() + 1;

      $body.scrollspy({
        target: target,
        offset: parseInt(offset)
      });
    },

//
// smooth scroll
// --------------------------------------------------
//

    fn_smoothScroll: function() {
      $('[data-smooth-scroll="true"]').on('click', function(e) {
        e.preventDefault();

        var id = $(this).attr('href');

        if ($(id).is(':visible')) {
          var offset = $(id).offset().top - $('.page-navbar').find('.navbar-header').outerHeight();

          $('html, body').stop().animate({
            scrollTop: offset
          }, 1250);
        }
      });
    },

//
// sticky
// --------------------------------------------------
//

    fn_sticky: function() {
      if ($(window).scrollTop() > 0) {
        $html.removeClass('js-no-scroll');
        $html.addClass('js-is-scroll');
      } else {
        $html.removeClass('js-is-scroll');
        $html.addClass('js-no-scroll');
      }
    },

//
// hero
// --------------------------------------------------
//

    fn_hero: function() {
      var $hero = $('.js-hero, .page-intro-hero');

      $hero.css('height', $(window).height() + 'px');
    },

//
// animation
// --------------------------------------------------
//

    fn_animation: function() {
      if (!isMobile && Modernizr.cssanimations && Modernizr.csstransforms && Modernizr.csstransforms3d && Modernizr.csstransitions) {
        setTimeout(function() {
          var wow = new WOW();

          wow.init();
        }, pageLoaderDuration);
      } else {
        $('.wow').removeClass('wow');
      }
    },

//
// carousel
// --------------------------------------------------
//

    fn_carousel: function() {
      var $carousel = $('.bfc-carousel');

      if ($carousel.length) {
        $carousel.slick();
      }
    },

//
// popup
// --------------------------------------------------
//

    fn_popup: function() {
      var $popupIframe = $('.popup-youtube, .popup-vimeo, .popup-gmaps');

      $popupIframe.each(function() {
        var $this = $(this);

        $popupIframe.magnificPopup({
          items: {
            src: $popupIframe.data('mfp-src'),
          },
          type: 'iframe',
          midClick: true,
          fixedContentPos: true,
          fixedBgPos: true,
          closeMarkup: '<button title="%title%" type="button" class="mfp-close text-primary">&#215;</button>',
          callbacks: {
            beforeOpen: function() {
              if (!$this.hasClass('popup-gmaps')) {
                $('.js-bg-youtube-is-playing').each(function() {
                  $(this).YTPPause().toggleClass('js-bg-youtube-is-playing --js-bg-youtube-is-paused');
                });

                var $bgAudioPlayer = $('#bgAudioPlayer');

                if ($bgAudioPlayer.length && !$bgAudioPlayer[0].paused) {
                  $bgAudioPlayer[0].pause();
                  $html.toggleClass('js-bg-audio-is-playing --js-bg-audio-is-paused');
                }
              }
            },
            afterClose: function() {
              if (!$this.hasClass('popup-gmaps')) {
                $('.--js-bg-youtube-is-paused').each(function() {
                  $(this).YTPPlay().toggleClass('--js-bg-youtube-is-paused js-bg-youtube-is-playing');
                });          

                var $bgAudioPlayer = $('#bgAudioPlayer');

                if ($bgAudioPlayer.length && $html.hasClass('--js-bg-audio-is-paused')) {
                  $bgAudioPlayer[0].play();
                  $html.toggleClass('--js-bg-audio-is-paused js-bg-audio-is-playing');
                }
              }
            },
          }
        });
      });

      var $popupInline = $('.popup-inline');

      $popupInline.each(function() {
        var $this = $(this);

        $this.magnificPopup({
          type: 'inline',
          midClick: true,
          closeMarkup: '<button title="%title%" type="button" class="mfp-close text-primary">&#215;</button>',
          closeBtnInside: true,
          fixedContentPos: true,
          fixedBgPos: true,
        });
      });
    },

//
// form
// --------------------------------------------------
//

    fn_form: function() {
      $('.form').each(function() {
        var $form = $(this);
        var $formControl = $form.find('.form-control');
        var $formNotify = $form.find('.form-notify');
        var formUrl = $form.data('action');

        $formControl.each(function() {
          var $this = $(this);

          $this.on('focus', function() {
            $(this).parent('.form-group').addClass('focus');
          }).on('blur', function() {
            $(this).parent('.form-group').removeClass('focus');
          });
        });

        $form.validate({
          onclick: false,
          onfocusout: false,
          onkeyup: false,
          ignore: '.ignore',
          rules: {
            fname: {
              required: true
            },
            lname: {
              required: true
            },
            name: {
              required: true
            },
            email: {
              required: true,
              email: true
            },
            message: {
              required: true
            },
            agree: {
              required: true
            },
          },
          errorPlacement: function(error, element) {},
          highlight: function(element) {
            $(element).closest('.form-group').addClass('error');
          },
          unhighlight: function(element) {
            $(element).closest('.form-group').removeClass('error');
          },
          submitHandler: function(form) {
            $.ajax({
              type: 'POST',
              dataType: 'json',
              url: formUrl,
              cache: false,
              data: $form.serialize(),
              success: function(data) {
                if (data.type != 'success') {
                  $formNotify.html('<i class="form-notify-icon-error"></i> ' + data.msg).show();
                } else {
                  $form.validate().resetForm();
                  $form[0].reset();
                  $form.find('.error').removeClass('error');
                  $form.addClass('successfully');
                  $form.find('button').blur();
                  $formNotify.html('<i class="form-notify-icon-success"></i> ' + data.msg).show();
                }
              },
              error: function(XMLHttpRequest, textStatus, errorThrown) {
                $formNotify.html('<i class="form-notify-icon-error"></i> An error occurred. Please try again later.').show();
              },
            });
          },
          invalidHandler: function(event, validator) {
            var errors = validator.numberOfInvalids();

            if (errors) {
              var message = errors == 1 ?
              '<i class="form-notify-icon-error"></i>You missed 1 field. It has been highlighted.' :
              '<i class="form-notify-icon-error"></i>You missed ' + errors + ' fields. They have been highlighted.';
              $formNotify.html(message).show();
            }
          }
        });
      });
    },

//
// slide
// --------------------------------------------------

    fn_slideshow: function() {
      $('.bg-slideshow').each(function() {
        var $this = $(this);

        var slides = [];
        for (var i = 1; i <= $this.data('slideshow-img-amount'); i++) {
          slides.push({
            src: $this.data('slideshow-img-src').replace('%', i)
          })
        }

        $this.vegas({
          slides: slides,
          delay: 7000
        });
      });
    },

//
// youtube
// --------------------------------------------------

    fn_youtube: function() {
      if ($('.bg-youtube').length) {
        $('.bg-youtube').each(function() {
          var $container = $(this);
          var $player = $container.find('.bg-youtube-player');

          if (isMobile) {
            $container.find('.bg-youtube-placeholder').remove();
          } else {
            $container.find('.bg-youtube-fallback').remove();
            $player.YTPlayer();
            $player.on('YTPPlay', function() {
              $(this).addClass('js-bg-youtube-is-playing').removeClass('js-bg-youtube-is-paused');
            });
            $player.on('YTPPause', function() {
              $(this).addClass('js-bg-youtube-is-paused').removeClass('js-bg-youtube-is-playing');
            });
          }
        });
      }
    },

//
// bg audio
// --------------------------------------------------
//

    fn_bgAudio: function() {
      if ($('#bgAudioPlayer').length) {
        var $player = $('#bgAudioPlayer');

        if (isMobile) {
          $player[0].pause();
          $html.addClass('js-bg-audio-is-paused');
        } else {
          $player[0].play();
          $html.addClass('js-bg-audio-is-playing');
        }

        $('.bg-audio-toggle').find('a').on('click', function(e) {
          e.preventDefault();

          if ($player[0].paused) {
            $player[0].play();
            $html.toggleClass('js-bg-audio-is-paused js-bg-audio-is-playing');
          } else {
            $player[0].pause();
            $html.toggleClass('js-bg-audio-is-playing js-bg-audio-is-paused');
          }
        });
      }
    },

//
// utility
// --------------------------------------------------

    fn_utility: function() {
      $('[data-css-opacity]').each(function() {
        var $this = $(this);
        $this.css('opacity', $this.data('css-opacity'));
      });

      $('[data-css-background-image]').each(function() {
        var $this = $(this);
        $this.css('background-image', 'url(' + $this.data('css-background-image') + ')');
      });

      $('[data-css-background-image-mobile]').each(function() {
        if (isMobile) {
          var $this = $(this);
          $this.css('background-image', 'url(' + $this.data('css-background-image-mobile') + ')');
        }
      });

      $('[data-css-background-image-desktop]').each(function() {
        if (isDesktop) {
          var $this = $(this);
          $this.css('background-image', 'url(' + $this.data('css-background-image-desktop') + ')');
        }
      });
    },

//
// end of BONEFISHCODE
// --------------------------------------------------

  };

//
// global variable
// --------------------------------------------------
//

  var $html = $('html'),
      $body = $('body'),
      easeInOutQuart = [0.770, 0.000, 0.175, 1.000],
      isMobile,
      isDesktop,
      pageLoaderDuration = 0;
      if ($('.page-loader').length && typeof BONEFISHCODE.fn_pageLoader !== 'undefined' && $.isFunction(BONEFISHCODE.fn_pageLoader)) {
        pageLoaderDuration = 1500;
      }
//
// init
// --------------------------------------------------

	$(function() {
		BONEFISHCODE.ready();
    $(window).on('load', function() {
      BONEFISHCODE.load();
    });
    $(window).on('scroll', function() {
      BONEFISHCODE.scroll();
    });
    $(window).on('resize', function() {
      BONEFISHCODE.resize();
    });
    $(window).on('orientationchange', function() {
      BONEFISHCODE.scroll();
    });
	});

//
// function end
// --------------------------------------------------
//

})(jQuery);
